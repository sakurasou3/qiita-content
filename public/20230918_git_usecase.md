---
title: gitを扱うツールの変遷〜Github DesktopからVSCodeへ〜
tags:
  - "github"
private: true
updated_at: ""
id: null
organization_url_name: null
slide: false
---

# rebase というトラウマ

git コマンドを使い始めて長らく経ちますが、未だに使い慣れないコマンド。
その最たるものが個人的には rebase でした。

どういう時に使えばいいのか、それを使うことによって何が嬉しいのか。
それが理解できなかったことと、rebase を避ける手段があったことから、今まで逃げられるだけ逃げ続けてきました。
ところが今の現場は rebase してコミット履歴を綺麗に運用していく方針が決定し、rebase から逃げる手段を失ってしまいました。

今回は長年 git を GUI で使い続けて楽をしてきた私が、コマンド実行に興味を持った結果、今の git 環境についてお話しします。

# 今までお世話になっていたツール： Github Desktop

今の現場に配属になるまでは、git 操作といえばもっぱら Github Desktop を使っていました。
リポジトリのクローン、コミット、push、pull、cherry-pick という基本的な操作が直感的に操作できることと、
名前の通り Github が出しているものなので、安心して使い続けていました。
https://desktop.github.com/

コマンドでも同じかと思いますが、git 操作で最もめんどくさ、、、と思うのが、コンフリクト発生時かと思います。
自分の見知った範囲のコンフリクトなら、こう直せばいいという判断がすぐできても、
チーム内の他の人が修正した範囲とのコンフリクトとなると、正直手がつけられない。
ここまでくると、もはや Github Desktop では対処しきれず、ブランチを切り直すことも多々ありました。

このままではエンジニアを名乗れなくなる…！
という危機感も出てきて、（ようやく）git を勉強しなおす決意をしました。

# 今の git 環境： VSCode

とはいえ git 管理だけのために GUI を使うことの最大のデメリット、それはアプリをいちいち切り替えないといけないことでした。
そう考えると、普段 VSCode で開発していて、git コマンドを実行するためにターミナルを開いていたら、GUI の方がよくない？とも思えてしまう。
それなら VSCode についているソース管理機能とターミナルを使い倒してやろう、という結論に行きつきました。

## 事前準備

- GitLens の設定
- difftool、mergetool に vscode を設定する

## 普段の使い方

1. git add

git 操作のうち、GUI の方が圧倒的に使いやすい機能。それは diff を見ることです。
その点、VSCode の左端についているソース管理は、1 ファイルごとにどう変更したのか差分がしっかり見られるし、git add もこれは add する、これはまだ、という判断ができます。
不具合解析にのめり込んでいくと、至る所にログを仕込みがちな私としては、git diff で差分を見るよりこちらの方がお手軽です。

2. git commit

ソース管理を開くといきなり見えているコミットボタンもしっかり使います。
余談ですが今の現場にはコミットメッセージにある程度の規則があります。
`git commit -m` の形だと何故かその規約が頭からすっぽ抜けてしまい、規約に反したコミットメッセージをつけがちなので、個人的にはこの機能が必須です。

3. git rebase -i

これは人によるかもですが、開発中は個人的にアサインされたタスクの中でも、ここまではできた、という状態でこまめにコミットしたいタイプです。
画面の大枠できた → コミット、state の定義できた → コミット、test はまだだけど実装はできた → コミット。
こんな感じで、最低限ここまで戻せば動く状態に戻せるという補償の意味でコミットを刻みがちです。

とはいえ「コミット履歴を綺麗に保つ」を運用方針に掲げている今の現場で、ここまで刻んだコミットのまま PR を出せるはずもありません。
これを PR に出せる状態にするために、git rebase して綺麗にします。
（余談）
ちなみに git rebase -i はコマンドこそターミナルで行いますが、その後のインタラクティブな部分は VSCode にお任せします。
どこまでいっても自分の打ち間違いが怖いので、可能な限りは GUI を頼りたい精神。

3. git push

これは、push だけは、ターミナルでやると決めています。
理由はコマンド実行すると、PR 作成の URL が出てきてブラウザ直アクセスができるから。
ボタンで push してしまうと、自分で github にアクセスして、リポジトリに飛んで、PR 作成しないといけない手間を削減できるので、コマンド実行がおすすめです。

4. git rebase

ここからは PR レビューが終わったあとの話になります。
大きな機能になればなるほど、PR レビューに時間がかかります。
PR に Approve いただくまでの間にマージ先のコミットが進むことは日常茶飯事だけど、コミット履歴は（以下略）。
なので`git rebase`でマージ先の最新コミットを取り込み・自分のコミットをその後に作り直します。
以前はコンフリクトが怖くて震えていた作業ですが、今は仮にコンフリクトしたところで、VSCode のマージツールを経由して解消できています。

# 最後に

git の勉強ではないですが、関連のため。
Qiita の投稿が github 管理できるようになったとのことで、早速導入してみました。
慣れた VSCode で記事を書け、push すると自動で投稿できて超絶快適なのでおすすめです。
最近の Qiita はダークモード対応もしてくれたりと、エンジニアに優しい取り組みをしてくれていて嬉しい限りです。
https://qiita.com/Qiita/items/32c79014509987541130

# 参考文献

独習 Git

この本の 16 章に rebase の章があるのを確認した上で購入。
正直これは学生が読むものじゃないか、という固定概念を捨てながら、和訳本独特の読みにくさこそあれど、rebase の章は目から鱗でした。
読むまでは squash が rebase の一部ということすら理解できてなかったので、この章だけでも購入してよかったなという印象を持ちました。
